add_genocide_cb_rewards = {
    save_temporary_scope_value_as = { name = attacker_culture_reward_mult value = 0 }
    save_temporary_scope_value_as = { name = attacker_faith_reward_mult value = 0 }
    save_temporary_scope_value_as = { name = defender_culture_reward_mult value = 0 }
    save_temporary_scope_value_as = { name = defender_faith_reward_mult value = 0 }
    scope:defender = {
        every_realm_county = {
            limit = {
                OR = {
                    AND = {
                        has_variable = culture_genocided
                        var:culture_genocided = scope:attacker.culture
                    }

                    AND = {
                        has_variable = faith_genocided
                        var:faith_genocided = scope:attacker.faith
                    }
                }
            }

            if = {
                limit = {
                    has_variable = culture_genocided
                }

                root = {
                    save_temporary_scope_value_as = {
                        name = attacker_culture_reward_mult
                        value = {
                            value = scope:attacker_culture_reward_mult
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:win
                                }
                                add = 1
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:white_peace
                                }
                                add = 0.5
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:loss
                                }
                                add = -1
                            }
                        }
                    }
                    save_temporary_scope_value_as = {
                        name = defender_culture_reward_mult
                        value = {
                            value = scope:defender_culture_reward_mult
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:win
                                }
                                add = -1
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:loss
                                }
                                add = 1
                            }
                        }
                    }

                }
            }
            if = {
                limit = {
                    has_variable = faith_genocided
                }

                root = {
                    save_temporary_scope_value_as = {
                        name = attacker_faith_reward_mult
                        value = {
                            value = scope:attacker_faith_reward_mult
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:win
                                }
                                add = 1
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:white_peace
                                }
                                add = 0.5
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:loss
                                }
                                add = -1
                            }
                        }
                    }
                    save_temporary_scope_value_as = {
                        name = defender_faith_reward_mult
                        value = {
                            value = scope:defender_faith_reward_mult
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:win
                                }
                                add = -1
                            }
                            if =  {
                                limit = {
                                    $OUTCOME$ = flag:loss
                                }
                                add = 1
                            }
                        }
                    }

                }
            }

            if = {
                limit = {
                    $OUTCOME$ = flag:win
                }

                change_title_holder = {
                    holder = scope:attacker
                    change = scope:change
                    take_baronies = yes
                }
            }
        }
    }

    scope:attacker = {
        add_prestige = {
            value = $PRESTIGE_BASE_VALUE$
            multiply = scope:attacker_culture_reward_mult
        }
    }

    scope:attacker = {
        add_piety = {
            value = $PIETY_BASE_VALUE$
            multiply = scope:attacker_faith_reward_mult
        }
    }

    scope:defender = {
        if = {
            limit = {
                NOT = {
                    scope:defender_culture_reward_mult = 0
                }
            }
            add_prestige = {
                value = $PRESTIGE_BASE_VALUE$
                multiply = scope:defender_culture_reward_mult
            }
        }
    }

    scope:defender = {
        if = {
            limit = {
                NOT = {
                    scope:defender_faith_reward_mult = 0
                }
            }
            add_piety = {
                value = $PIETY_BASE_VALUE$
                multiply = scope:defender_faith_reward_mult
            }
        }
    }
}

modify_allies_of_participants_fame_values_genocide = {
    # Give the allies of both primary participants the appropriate type & amount of 'fame'.

    if = {
        # Religious wars award Piety to participants.
        limit = {
            OR = {
                $GIVE_FAITH_REWARDS$ = yes
                #always = yes
            }
        }
        if = {
            # Award Piety to the victorious attacker's allies.
            limit = {
                $WINNER$ = scope:attacker
            }
            add_from_contribution_attackers = {
                piety = {
                    value = $FAME_BASE$
                    multiply = $WINNER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
            # Award Piety to the defeated defender's allies.
            add_from_contribution_defenders = {
                piety = {
                    value = $FAME_BASE$
                    multiply = $LOSER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
        }
        else = {
            # Award Piety to the victorious defender's allies.
            add_from_contribution_defenders = {
                piety = {
                    value = $FAME_BASE$
                    multiply = $WINNER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
            # Award Piety to the defeated attacker's allies.
            add_from_contribution_attackers = {
                piety = {
                    value = $FAME_BASE$
                    multiply = $LOSER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
        }
    }
    if = {
        limit = {
            $GIVE_CULTURE_REWARDS$ = yes
        }
        # All other war types award Prestige to participants.
        if = {
            # Award Prestige to the victorious attacker's allies.
            limit = {
                $WINNER$ = scope:attacker
            }
            add_from_contribution_attackers = {
                prestige = {
                    value = $FAME_BASE$
                    multiply = $WINNER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
            # Award Prestige to the defeated defender's allies.
            add_from_contribution_defenders = {
                prestige = {
                    value = $FAME_BASE$
                    multiply = $LOSER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
        }
        else = {
            # Award Prestige to the victorious defender's allies.
            add_from_contribution_defenders = {
                prestige = {
                    value = $FAME_BASE$
                    multiply = $WINNER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
            # Award Prestige to the defeated attacker's allies.
            add_from_contribution_attackers = {
                prestige = {
                    value = $FAME_BASE$
                    multiply = $LOSER_ALLY_FAME_SCALE$
                }
                opinion = {
                    modifier = contributed_in_war
                }
            }
        }
    }
}